<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mju.bishe.mapper.WorkloadTotalMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.mju.bishe.entity.WorkloadTotal">
        <id column="id" property="id" />
        <result column="teacher_id" property="teacherId" />
        <result column="school_year" property="schoolYear" />
        <result column="school_term" property="schoolTerm" />
        <result column="theoretical_wordload_total" property="theoreticalWordloadTotal" />
        <result column="practical_wordload_total" property="practicalWordloadTotal" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, teacher_id, school_year, school_term,theoretical_wordload_total, practical_wordload_total
    </sql>
    
    <select id="getList" resultType="com.mju.bishe.entity.WorkloadTotal">
        SELECT
            sum( tb.theoretical_wordload ) as theoreticalWordloadTotal,
            sum( tb.practical_wordload ) as practicalWordloadTotal,
            tb.school_year as schoolYear,
            tb.school_term as schoolTerm,
            t.name as teacherName,
            t.positional_title as positionalTitle,
            count(tb.id) as classNum
        FROM
            workload tb
            left join teacher t on t.id = tb.teacher_id
            where 1 = 1
            <if test="queryfilter.name!=null and queryfilter.name!=''">
                and t.name like concat('%',#{queryfilter.name},'%')
            </if>
        GROUP BY
            tb.teacher_id,
            tb.school_year,
            tb.school_term
    </select>
</mapper>
